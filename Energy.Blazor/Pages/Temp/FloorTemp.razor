@page "/temp"
@using Energy.Blazor.Pages.Temp.Components;
@using Energy.Services.DTO;
@attribute [Authorize(Roles = "Admin")]

<PageTitle>Temp</PageTitle>


<div class="container-fluid h-100">
	<div class="row">
		<div class="col-12 mt-10 mb-10">
			<RadzenCard class="m-3">
				<RadzenText TextStyle="TextStyle.H6">
					List of Floors
				</RadzenText>
				<RadzenDataGrid @ref="_locationInformationGrid"
								TItem="LocationDTO"
								AllowPaging="true"
								PageSize="@PageSize"
								AllowColumnResize="true"
								SelectionMode="DataGridSelectionMode.Single"
								RowSelect="OnSelectedLocationFloor"
								AllowRowSelectOnRowClick="@(!IsTaskRunningService.IsTaskRunning)"
								PagerHorizontalAlign="HorizontalAlign.Center"
								IsLoading=@IsTaskRunningService.IsTaskRunning
								LoadData="@LoadData"
								Data="@_locationInformationFloor"
								Count="@Count">

					<Columns>
						<RadzenDataGridColumn TItem="LocationDTO" Property="Floor" Title="Floor"></RadzenDataGridColumn>
					</Columns>
				</RadzenDataGrid>
			</RadzenCard>
		</div>

		<div class="col-12">
			@if (!string.IsNullOrWhiteSpace(SelectedDetailedLocation.Floor))
			{
				<RadzenCard class="m-3">
					<RadzenText TextStyle="TextStyle.H6">
						List of Rooms
					</RadzenText>
					<RadzenDataGrid @ref="_locationInformationGrid"
									TItem="LocationDTO"
									AllowPaging="true"
									PageSize="@PageSize"
									AllowColumnResize="true"
									SelectionMode="DataGridSelectionMode.Single"
									RowSelect="OnSelectedLocationRoom"
									AllowRowSelectOnRowClick="@(!IsTaskRunningService.IsTaskRunning)"
									PagerHorizontalAlign="HorizontalAlign.Center"
									IsLoading=@IsTaskRunningService.IsTaskRunning
									LoadData="@LoadData"
									Data="@_locationInformationRoom"
									Count="@Count">

						<Columns>
							<RadzenDataGridColumn TItem="LocationDTO" Property="Room" Title="Room"></RadzenDataGridColumn>
						</Columns>
					</RadzenDataGrid>
				</RadzenCard>
				if (!string.IsNullOrWhiteSpace(SelectedDetailedLocation.Room))
				{
					<CascadingValue Value="@SelectedDetailedLocation">
						<Tempreture></Tempreture>
					</CascadingValue>
					
					<RadzenCard class="m-3">
						<RadzenText TextStyle="TextStyle.H6">
							Settings
						</RadzenText>
						<RadzenTextBox @bind-Value="_thermostatSettings.NewTemperature" Placeholder="New temperature"></RadzenTextBox><br />
					<RadzenTextBox @bind-Value="_thermostatSettings.NewHysteresis" Placeholder="New Hysteresis"></RadzenTextBox><br />
						<RadzenButton Click="NewSettingsSubmitAsync">Submit</RadzenButton>
					</RadzenCard>
				}
			}
		</div>
	</div>
</div> 